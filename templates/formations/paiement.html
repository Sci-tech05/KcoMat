{% extends 'base.html' %}
{% load humanize %}

{% block title %}Paiement des frais — {{ inscription.formation.titre }}{% endblock %}

{% block content %}

<!-- Fond dégradé sobre -->
<div class="min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-gray-100 py-10 px-4">
  <div class="max-w-xl mx-auto">

    <!-- ── En-tête ── -->
    <div class="text-center mb-8">
      <a href="{% url 'formations:detail' inscription.formation.slug %}"
         class="inline-flex items-center gap-1.5 text-xs text-gray-400 hover:text-gray-600 transition-colors mb-5 group">
        <svg class="w-3.5 h-3.5 transition-transform group-hover:-translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Retour à la formation
      </a>
      <div class="w-14 h-14 bg-gradient-to-br from-blue-600 to-blue-800 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-blue-500/30">
        <span class="text-white font-black text-xl tracking-tight">KC</span>
      </div>
      <h1 class="text-2xl font-black text-gray-900">Finaliser votre inscription</h1>
      <p class="text-gray-500 text-sm mt-1">Paiement sécurisé des frais d'inscription</p>
    </div>

    <!-- ── Récapitulatif inscription ── -->
    <div class="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden mb-5">

      <!-- ① En-tête formation : fond sombre + icône -->
      <div class="relative bg-gradient-to-br from-gray-900 via-blue-950 to-gray-900 px-6 py-5">
        <!-- Décor blur -->
        <div class="absolute inset-0 pointer-events-none overflow-hidden rounded-t-2xl">
          <div class="absolute -top-6 -right-6 w-32 h-32 bg-blue-600/20 rounded-full blur-2xl"></div>
        </div>
        <div class="relative flex items-center gap-4">
          <!-- Icône / image -->
          {% if inscription.formation.image %}
          <img src="{{ inscription.formation.image.url }}" alt="{{ inscription.formation.titre }}"
               class="w-14 h-14 rounded-xl object-cover ring-2 ring-white/15 flex-shrink-0 shadow-md" />
          {% else %}
          <div class="w-14 h-14 rounded-xl bg-blue-600/20 border border-blue-500/20 flex items-center justify-center flex-shrink-0">
            <svg class="w-7 h-7 text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
            </svg>
          </div>
          {% endif %}
          <!-- Infos formation -->
          <div class="min-w-0 flex-1">
            <div class="flex items-center gap-2 mb-1">
              <span class="text-[10px] font-bold text-blue-400 uppercase tracking-widest">Formation KcoMat</span>
              <span class="inline-flex items-center bg-blue-500/20 border border-blue-400/20 text-blue-300 text-[10px] font-semibold px-2 py-0.5 rounded-full">
                {{ inscription.formation.get_niveau_display }}
              </span>
            </div>
            <div class="text-white font-black text-lg leading-tight">{{ inscription.formation.titre }}</div>
            <div class="flex items-center gap-3 mt-1.5 text-xs text-gray-400">
              <span class="flex items-center gap-1">
                <svg class="w-3 h-3 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                {{ inscription.formation.duree }}
              </span>
              <span class="flex items-center gap-1">
                <svg class="w-3 h-3 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                Lokossa, Bénin
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- ② Infos participant : rangées avec icônes -->
      <div class="px-5 py-4 space-y-2.5">
        <div class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-3">Participant</div>

        <div class="flex items-center gap-3 text-sm">
          <div class="w-7 h-7 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0">
            <svg class="w-3.5 h-3.5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
          </div>
          <span class="text-gray-400 w-16 flex-shrink-0">Nom</span>
          <span class="font-semibold text-gray-800">{{ inscription.prenom }} {{ inscription.nom }}</span>
        </div>

        <div class="flex items-center gap-3 text-sm">
          <div class="w-7 h-7 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0">
            <svg class="w-3.5 h-3.5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          </div>
          <span class="text-gray-400 w-16 flex-shrink-0">Email</span>
          <span class="font-semibold text-gray-800 truncate">{{ inscription.email }}</span>
        </div>

        <div class="flex items-center gap-3 text-sm">
          <div class="w-7 h-7 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0">
            <svg class="w-3.5 h-3.5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.948V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>
          </div>
          <span class="text-gray-400 w-16 flex-shrink-0">Tél.</span>
          <span class="font-semibold text-gray-800">{{ inscription.telephone }}</span>
        </div>
      </div>

      <!-- ③ Récapitulatif financier : style reçu -->
      <div class="mx-5 mb-5 rounded-xl overflow-hidden border border-gray-100">
        <!-- Ligne formation -->
        <div class="flex items-center justify-between px-4 py-3 bg-gray-50 text-sm">
          <span class="text-gray-500">Prix de la formation</span>
          <span class="font-semibold text-gray-700">{{ inscription.formation.prix|intcomma }} <span class="text-gray-400 text-xs">FCFA</span></span>
        </div>
        <!-- Séparateur pointillé -->
        <div class="border-t border-dashed border-gray-200"></div>
        <!-- Ligne frais — mise en avant -->
        <div class="flex items-center justify-between px-4 py-3 bg-amber-50">
          <div>
            <div class="text-xs font-bold text-amber-800">Frais d'inscription</div>
            <div class="text-[11px] text-amber-600 flex items-center gap-1 mt-0.5">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
              Attestation officielle KcoMat incluse
            </div>
          </div>
          <span class="text-xl font-black text-amber-700">{{ frais|intcomma }} <span class="text-xs font-semibold">FCFA</span></span>
        </div>
        <!-- Total à payer maintenant -->
        <div class="flex items-center justify-between px-4 py-3 bg-blue-600">
          <span class="text-blue-100 text-xs font-bold uppercase tracking-wide">À payer maintenant</span>
          <span class="text-white text-lg font-black">{{ frais|intcomma }} <span class="text-blue-200 text-xs font-semibold">FCFA</span></span>
        </div>
      </div>

    </div>

    <!-- ── Comment ça marche ── -->
    <div class="bg-white rounded-2xl border border-gray-100 shadow-sm px-5 py-4 mb-5">
      <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4">Comment ça marche ?</h3>
      <ol class="space-y-3">
        <li class="flex items-start gap-3">
          <div class="w-6 h-6 rounded-full bg-blue-600 text-white text-xs font-black flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm shadow-blue-300">1</div>
          <div class="text-sm text-gray-600">Cliquez sur <strong class="text-gray-800">« Payer maintenant »</strong> pour être redirigé vers Fedapay</div>
        </li>
        <li class="flex items-start gap-3">
          <div class="w-6 h-6 rounded-full bg-blue-600 text-white text-xs font-black flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm shadow-blue-300">2</div>
          <div class="text-sm text-gray-600">Payez <strong class="text-gray-800">{{ frais|intcomma }} FCFA</strong> via Mobile Money (MTN, Moov, Celtiis…)</div>
        </li>
        <li class="flex items-start gap-3">
          <div class="w-6 h-6 rounded-full bg-blue-600 text-white text-xs font-black flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm shadow-blue-300">3</div>
          <div class="text-sm text-gray-600">Vous recevrez un <strong class="text-gray-800">email de confirmation</strong> et votre convocation de formation</div>
        </li>
      </ol>
    </div>

    <!-- ── Bouton paiement ── -->
    <a href="{% url 'formations:paiement_frais' inscription.id %}"
       class="flex items-center justify-center gap-3 w-full bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-black py-4 rounded-2xl text-base transition-colors shadow-lg shadow-blue-400/30 mb-3">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
      </svg>
      Payer {{ frais|intcomma }} FCFA maintenant
    </a>

    <!-- Badges sécurité -->
    <div class="flex items-center justify-center gap-4 text-xs text-gray-400 mb-6">
      <span class="flex items-center gap-1">
        <svg class="w-3.5 h-3.5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
        Paiement sécurisé SSL
      </span>
      <span class="text-gray-200">|</span>
      <span class="flex items-center gap-1">
        <svg class="w-3.5 h-3.5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
        Mobile Money Bénin
      </span>
      <span class="text-gray-200">|</span>
      <span>Fedapay</span>
    </div>

    <!-- Lien annuler -->
    <div class="text-center">
      <a href="{% url 'formations:detail' inscription.formation.slug %}"
         class="text-xs text-gray-400 hover:text-gray-600 transition-colors underline underline-offset-2">
        Annuler et revenir à la formation
      </a>
    </div>

  </div>
</div>

{% endblock %}